(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6c61c457"],{"347c":function(e,t,n){e.exports=n.p+"img/pin1.d74f27bd.svg"},"67f8":function(e,t,n){"use strict";n.r(t);var o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-container",[n("v-breadcrumbs",{staticClass:"mt-n4",attrs:{large:""}},[n("v-btn",{staticClass:"text-primary",attrs:{text:""},on:{click:function(t){return e.backPrevios()}}},[n("v-icon",[e._v("mdi-keyboard-backspace")])],1),e._v("Export ຂໍ້ມູນລູກຄ້າບໍລິສັດໃນແຜນເສັ້ນທາງ "),n("v-spacer"),n("span",{staticClass:"mr-4"},[n("v-icon",{attrs:{color:"red"}},[e._v("mdi-map-marker")]),e._v("ຢູ່ໃນແຜນແລ້ວ ")],1),n("span",[n("v-icon",{staticStyle:{color:"#49a3da"}},[e._v("mdi-map-marker")]),e._v("ຍັງບໍທັນຢູ່ໃນແຜນ ")],1)],1),n("v-row",[n("v-col",{staticClass:"mb-4",attrs:{cols:"12"}},[e.customers?n("GmapMap",{staticStyle:{width:"100%",height:"450px"},attrs:{center:e.getCenter().lat>0||e.getCenter().lat<0?e.getCenter():{lat:0,lng:0},zoom:14,disableDefaultUI:!0}},[n("gmap-info-window",{attrs:{options:e.infoOptions,position:e.infoPosition,opened:e.infoOpened,conent:e.infoContent},on:{closeclick:function(t){e.infoOpened=!1}}},[e._v(e._s(e.infoContent))]),e._l(e.customers,(function(t,o){return n("GmapMarker",{key:o,attrs:{position:e.getMarkers(t),draggable:!1,icon:e.getSiteIcon(t),animation:2,clickable:!0,label:(o+1).toString()},on:{click:function(n){return e.toggleInfo(t,o)}}})}))],2):e._e()],1)],1),n("v-row",{staticClass:"mb-n6"},[n("v-col",[n("v-btn",{staticClass:"btn-primary",attrs:{loading:e.loading,disabled:e.loading},on:{click:function(t){return e.exportRoutePlan()}}},[n("v-icon",[e._v("mdi-arrow-right-bold-circle-outline")])],1)],1),n("v-col",[e.customers?n("h4",[e._v("ລວມລູກຄ້າ "+e._s(e.customers.length)+" ຄົນ")]):e._e()]),n("v-col",[n("v-text-field",{attrs:{outlined:"",dense:"",clearable:"","prepend-inner-icon":"mdi-magnify",label:"Search",type:"text"},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.Search()}},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})],1)],1),n("div",[n("v-card",[n("v-card",{attrs:{flat:""}},[n("v-card-text",[n("div",[n("v-btn",{attrs:{text:"",color:"error"},on:{click:e.deleteItem}},[n("v-icon",{attrs:{medium:""}},[e._v("mdi-delete")])],1)],1),n("v-data-table",{attrs:{headers:e.headers,items:e.customers,search:e.search,"disable-pagination":!0,"hide-default-footer":"","show-select":""},scopedSlots:e._u([{key:"item.index",fn:function(t){return[n("div",[e._v(e._s(t.index+1))])]}},{key:"item.address_detail",fn:function(t){var o=t.item;return e._l(o.village_details,(function(t,o){return n("div",{key:o},[n("span",[e._v(e._s(t.name))])])}))}},{key:"item.address",fn:function(t){var o=t.item;return[o.district&&o.village?n("div",[e._v(e._s(o.district.name)+", "+e._s(o.village.name))]):e._e()]}},{key:"item.actions",fn:function(t){var o=t.item;return[n("v-icon",{staticClass:"mr-2",attrs:{small:""},on:{click:function(t){return e.viewPage(o.id)}}},[e._v("mdi-eye")])]}}]),model:{value:e.selectedRows,callback:function(t){e.selectedRows=t},expression:"selectedRows"}})],1)],1)],1)],1),n("ModalDelete",[[n("v-card-actions",[n("v-spacer"),n("v-btn",{attrs:{color:"blue darken-1",text:""},on:{click:e.closeDelete}},[e._v("Cancel")]),n("v-btn",{attrs:{color:"blue darken-1",text:"",loading:e.loading,disabled:e.loading},on:{click:e.deleteItemConfirm}},[e._v("OK")]),n("v-spacer")],1)]],2)],1)},a=[],s=(n("a434"),n("4de4"),n("d3b7"),n("3ca3"),n("ddb0"),n("2b3d"),n("9861"),{name:"Company",title:function(){return"Vientiane Waste Co-Dev|Export Company"},props:["items","villages"],data:function(){return{customers:[],countcutomer:0,loading:!1,customerId:"",search:"",oldVal:"",selectedVillage:[],selectedCustomer:[],exclude_company:[],selectedRows:[],customer:{},headers:[{text:"ບໍລິສັດ",value:"company_name"},{text:"Phone",value:"user.phone",sortable:!1},{text:"ລາຍລະອຽດທີ່ຢູ່",value:"address_detail"},{text:"ບ້ານ",value:"village.name",sortable:!0},{text:"ເມືອງ",value:"district.name",sortable:!0}],latlng:{lat:0,lng:0},markers:[],infoPosition:null,infoContent:null,infoOpened:!1,infoCurrentKey:null,infoOptions:{pixelOffset:{width:0,height:-35}}}},methods:{backPrevios:function(){this.$router.go(-1)},fetchData:function(){this.customers=this.items,this.selectedVillage=this.villages},closeDelete:function(){this.$store.commit("modalDelete_State",!1)},deleteItem:function(){this.selectedRows.length>0&&this.$store.commit("modalDelete_State",!0)},deleteItemConfirm:function(){var e=this;this.selectedCustomer=[],this.loading=!0;for(var t=0;t<this.selectedRows.length;t++){var n=this.customers.indexOf(this.selectedRows[t]);this.selectedCustomer.push(this.customers[n]),this.customers.splice(n,1)}this.selectedCustomer.filter((function(t){e.exclude_company.push(t.id)})),this.$store.commit("Toast_State",{value:!0,color:"success",msg:"ລຶບຂໍ້ມູນສຳເລັດແລ້ວ"}),this.selectedRows=[],this.fetchData(),this.loading=!1,this.$store.commit("modalDelete_State",!1)},exportRoutePlan:function(){var e=this;this.customers.length>0?(this.loading=!0,this.$axios.post("export-company-location",{headers:{exclude_companies:this.exclude_company,villages:this.selectedVillage}},{responseType:"blob"}).then((function(t){200==t.status&&(console.log("Success"),setTimeout((function(){e.loading=!1;var n=window.URL.createObjectURL(new Blob([t.data])),o=document.createElement("a");o.href=n,o.setAttribute("download","company_location.xlsx"),document.body.appendChild(o),o.click(),document.body.removeChild(o)}),300),e.$router.push({name:"Plan"}))})).catch((function(t){e.$store.commit("Toast_State",{value:!0,color:"error",msg:t.response?t.response.data.message:"Something went wrong"}),e.loading=!1}))):this.$store.commit("Toast_State",{value:!0,color:"error",msg:"ກາລຸນາເລືອກລູກຄ້າກ່ອນ"})},viewPage:function(e){this.$router.push({name:"ViewClient",params:{id:e}})},getCenter:function(){if(this.customers.length){if(null==parseFloat(this.customers[0].lat))return this.latlng;var e={lat:parseFloat(this.customers[0].lat),lng:parseFloat(this.customers[0].lng)};return e}return this.latlng},getMarkers:function(e){if(null!==e.customer)return{lat:parseFloat(e.lat),lng:parseFloat(e.lng)}},getSiteIcon:function(e){var t={url:n("347c"),zoomControl:!0,mapTypeControl:!1,scaleControl:!1,streetViewControl:!1,rotateControl:!1,fullscreenControl:!1,disableDefaultUi:!1,size:{width:35,height:55,f:"px",b:"px"},scaledSize:{width:35,height:55,f:"px",b:"px"}},o={url:n("f742"),zoomControl:!0,mapTypeControl:!1,scaleControl:!1,streetViewControl:!1,rotateControl:!1,fullscreenControl:!1,disableDefaultUi:!1,size:{width:35,height:55,f:"px",b:"px"},scaledSize:{width:35,height:55,f:"px",b:"px"}};try{switch(e.route_plan_details_count){case 0:return t;case 1:return o}}catch(a){return t}},toggleInfo:function(e,t){this.infoPosition=this.getMarkers(e),this.infoContent=e.company_name,this.infoCurrentKey==t?this.infoOpened=!this.infoOpened:(this.infoOpened=!0,this.infoCurrentKey=t)}},watch:{search:function(e){""==e&&this.fetchData()}},created:function(){this.fetchData()}}),i=s,r=(n("d677"),n("2877")),l=n("6544"),c=n.n(l),d=n("2bc5"),u=n("8336"),m=n("b0af"),h=n("99d9"),f=n("62ad"),p=n("a523"),v=n("8fea"),g=n("132d"),b=n("0fd9"),_=n("2fa4"),C=n("8654"),x=Object(r["a"])(i,o,a,!1,null,null,null);t["default"]=x.exports;c()(x,{VBreadcrumbs:d["a"],VBtn:u["a"],VCard:m["a"],VCardActions:h["a"],VCardText:h["b"],VCol:f["a"],VContainer:p["a"],VDataTable:v["a"],VIcon:g["a"],VRow:b["a"],VSpacer:_["a"],VTextField:C["a"]})},d677:function(e,t,n){"use strict";n("e866")},e866:function(e,t,n){},f742:function(e,t,n){e.exports=n.p+"img/pin2.b23d8eec.svg"}}]);
//# sourceMappingURL=chunk-6c61c457.e3a14fc4.js.map