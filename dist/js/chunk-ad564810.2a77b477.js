(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-ad564810"],{"04fe":function(t,e,a){},"8b47":function(t,e,a){"use strict";a("04fe")},fcfb:function(t,e,a){"use strict";a.r(e);var i=a("8336"),s=a("b0af"),o=a("99d9"),n=a("62ad"),r=a("a523"),c=a("4bd4"),l=a("adda"),h=a("1514"),d=a("0fd9"),p=a("8654"),u=function(){var t=this,e=t._self._c;return e(r["a"],[e("div",{attrs:{id:"recaptcha-container"}}),e(d["a"],{attrs:{align:"center",justify:"center"}},[e(n["a"],{attrs:{cols:"12",sm:"12",md:"12"}},[e(s["a"],{staticClass:"elevation-1",staticStyle:{display:"flex",margin:"auto"},attrs:{"max-width":"600"}},[e(o["b"],{staticClass:"py-16 px-16"},[e(d["a"],{attrs:{justify:"center"}},[e(n["a"],{attrs:{justify:"center"}},[e(l["a"],{staticClass:"logo",attrs:{src:a("de09"),"max-height":"150","max-width":"250",alt:"Logo"}})],1)],1),t.verifyPhone?e("div",[e("h3",{staticClass:"text-center display-5 black--text mb-8 mt-4"},[t._v(" Your phone number ("+t._s(t.showPhone)+") ")]),e(p["a"],{staticClass:"input-number",attrs:{label:"Phone","single-line":"","prepend-inner-icon":"mdi-phone",solo:"",type:"number",rules:t.phoneRule},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.getOtp.apply(null,arguments)}},model:{value:t.phone,callback:function(e){t.phone=e},expression:"phone"}}),e("p",{staticClass:"errors"},[t._v(" "+t._s(t.error)+" ")]),e("div",{staticClass:"text-center"},[e(i["a"],{staticClass:"login mt-6 py-6",attrs:{block:"",loading:t.loading,disabled:t.loading},on:{click:t.getOtp}},[t._v(" Get OTP ")])],1)],1):t._e(),t.verifyCode?e("div",[e("h2",{staticClass:"text-center display-5 black--text mb-0 mt-4"},[t._v(" Verify Code OTP ")]),e("p",{staticClass:"text-center display-5 black--text mb-8 mt-0"},[t._v(" Input Code from SMS ")]),e(c["a"],{ref:"form",attrs:{"lazy-validation":""}},[e(d["a"],[e(n["a"],{attrs:{cols:"12",sm:"12",md:"12"}},[e("div",{staticStyle:{display:"flex","flex-direction":"row"}},[e(h["a"],{ref:"otpInput",staticClass:"otp",attrs:{"input-classes":"otp-input",separator:"","num-inputs":6,"should-auto-focus":!0,"is-input-num":!0},on:{"on-complete":t.handleOnComplete}}),e(i["a"],{staticStyle:{margin:"auto"},attrs:{text:"",small:""},on:{click:function(e){return t.handleClearInput()}}},[t._v(" Clear ")])],1)])],1),e("div",{staticClass:"text-center"},[e(i["a"],{staticClass:"login mt-6 py-6",attrs:{block:"",loading:t.btnVerify,disabled:t.btnVerify},on:{click:t.verifyOtp}},[t._v(" Confirm ")])],1)],1)],1):t._e()],1)],1)],1)],1)],1)},f=[],m=(a("14d9"),a("2f62")),g=a("2591"),y=a("a18c"),b={name:"CheckPhone",title(){return"Vientiane Waste Co-Dev|Login"},data:()=>({loading:!1,btnVerify:!1,verifyCode:!1,verifyPhone:!0,phone:"",showPhone:"",code:"",user:{},error:"",phoneRule:[t=>!!t||"Phone is required",t=>t&&t.length>=8||"Phone must be more than 8 characters"],appVerifier:""}),methods:{getOtp(){this.initReCaptcha(),8==this.phone.length&&(this.loading=!0,this.$axios.post("auth/check-phone",{credential:this.user.credential,password:this.user.password,phone:this.phone}).then(t=>{if(200===t.data.code){if(!0===t.data.data.collect){this.loading=!0;const t="+85620",e=t+this.phone,a=this.appVerifier;setTimeout(()=>{g["a"].auth().languageCode="en",g["a"].auth().signInWithPhoneNumber(e,a).then(t=>{window.confirmationResult=t,this.verifyCode=!0,this.verifyPhone=!1,this.loading=!1}).catch(t=>{this.error=t,this.loading=!1},15e3)})}else!1===t.data.data.collect?(this.loading=!1,this.error="ເບີໂທບໍ່ຖືກຕ້ອງ"):(this.loading=!1,this.error="ມີບາງຢ່າງຜິດພາດ ກະລຸນາລອງໃໝ່");this.loading=!1}}).catch(t=>{this.error=t,this.loading=!1}))},verifyOtp(){this.btnVerify=!0;const t=Array.from(this.$refs.otpInput.otp).join("");window.confirmationResult.confirm(t).then(t=>{if(t){this.btnVerify=!1;const e=t.user;console.log(e,"token"),localStorage.setItem("id_token",e._lat)}try{this.$store.commit("Loading_State",!0);const t=localStorage.getItem("id_token");console.log(t,"id_token");const e={...this.user,id_token:t};this.$store.dispatch("auth/confirmLogin",e)}catch(e){this.$store.commit("Toast_State",{value:!0,color:"success",msg:e})}finally{this.$store.commit("Toast_State",{value:!0,color:"success",msg:"Login Success"})}this.$store.commit("Loading_State",!1)}).catch((function(){this.$store.commit("Toast_State",{value:!0,color:"error",msg:"ມີບາງຢ່າງຜິດພາດ ກະລຸນາລອງໃໝ່"})}))},...Object(m["b"])({}),initReCaptcha(){window.recaptchaVerifier=new g["a"].auth.RecaptchaVerifier("recaptcha-container",{size:"invisible","expired-callback":function(){}}),this.appVerifier=window.recaptchaVerifier},handleOnComplete(t){this.code=t},handleClearInput(){this.$refs.otpInput.clearInput()}},watch:{phone(){this.error=""}},created(){const t=localStorage.getItem("confirmAccount");this.showPhone=this.$store.getters["auth/getLoginPhone"],this.user=JSON.parse(t),this.showPhone||y["a"].push({name:"Login"})}},v=b,C=(a("8b47"),a("2877")),k=Object(C["a"])(v,u,f,!1,null,null,null);e["default"]=k.exports}}]);
//# sourceMappingURL=chunk-ad564810.2a77b477.js.map