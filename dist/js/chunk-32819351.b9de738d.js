(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-32819351"],{"37f3":function(t,e,i){},"47f3":function(t,e,i){"use strict";i("37f3")},fcfb:function(t,e,i){"use strict";i.r(e);var a=i("07b0"),o=i("db5a"),s=i("0f35"),n=i("1da9"),r=i("1789"),c=i("565c"),l=i("0087"),h=i("5af6"),d=i("d62f"),p=i("9b44"),u=function(){var t=this,e=t._self._c;return e(r["a"],[e(d["a"],{attrs:{align:"center",justify:"center"}},[e(n["a"],{attrs:{cols:"12",sm:"12",md:"12"}},[e(o["a"],{staticClass:"elevation-1",staticStyle:{display:"flex",margin:"auto"},attrs:{"max-width":"600"}},[e(s["b"],{staticClass:"py-16 px-16"},[e(d["a"],{attrs:{justify:"center"}},[e(n["a"],{attrs:{justify:"center"}},[e(l["a"],{staticClass:"logo",attrs:{src:i("de09"),"max-height":"150","max-width":"250",alt:"Logo"}})],1)],1),t.verifyPhone?e("div",[e("h3",{staticClass:"text-center display-5 black--text mb-8 mt-4"},[t._v(" Your phone number ("+t._s(t.showPhone)+") ")]),e(p["a"],{staticClass:"input-number",attrs:{label:"Phone","single-line":"","prepend-inner-icon":"mdi-phone",solo:"",type:"number",rules:t.phoneRule},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.getOtp.apply(null,arguments)}},model:{value:t.phone,callback:function(e){t.phone=e},expression:"phone"}}),e("p",{staticClass:"errors"},[t._v(" "+t._s(t.error)+" ")]),e("div",{staticClass:"text-center"},[e(a["a"],{staticClass:"login mt-6 py-6",attrs:{block:"",loading:t.loading,disabled:t.loading},on:{click:t.getOtp}},[t._v(" Get OTP ")])],1)],1):t._e(),t.verifyCode?e("div",[e("h2",{staticClass:"text-center display-5 black--text mb-0 mt-4"},[t._v(" Verify Code OTP ")]),e("p",{staticClass:"text-center display-5 black--text mb-8 mt-0"},[t._v(" Input Code from SMS ")]),e(c["a"],{ref:"form",attrs:{"lazy-validation":""}},[e(d["a"],[e(n["a"],{attrs:{cols:"12",sm:"12",md:"12"}},[e("div",{staticStyle:{display:"flex","flex-direction":"row"}},[e(h["a"],{ref:"otpInput",staticClass:"otp",attrs:{"input-classes":"otp-input",separator:"","num-inputs":6,"should-auto-focus":!0,"is-input-num":!0},on:{"on-complete":t.handleOnComplete}}),e(a["a"],{staticStyle:{margin:"auto"},attrs:{text:"",small:""},on:{click:function(e){return t.handleClearInput()}}},[t._v(" Clear ")])],1)])],1),e("div",{staticClass:"text-center"},[e(a["a"],{staticClass:"login mt-6 py-6",attrs:{block:"",loading:t.btnVerify,disabled:t.btnVerify},on:{click:t.verifyOtp}},[t._v(" Confirm ")])],1)],1)],1):t._e()],1)],1)],1)],1),e("div",{attrs:{id:"recaptcha-container"}})],1)},m=[],f=(i("558b"),i("19d6")),g=i("d8aa"),y=i("a18c"),b={name:"CheckPhone",title(){return"Vientiane Waste Co-Dev|Login"},data:()=>({loading:!1,btnVerify:!1,verifyCode:!1,verifyPhone:!0,phone:"",showPhone:"",code:"",user:{},error:"",phoneRule:[t=>!!t||"Phone is required",t=>t&&t.length>=8||"Phone must be more than 8 characters"],appVerifier:""}),methods:{async getOtp(){try{8==this.phone.length&&(this.$store.commit("Loading_State",!0),this.loading=!0,this.$axios.post("auth/check-phone",{credential:this.user.credential,password:this.user.password,phone:this.phone}).then(t=>{if(200===t.data.code){if(!0===t.data.data.collect){const t="+85620",e=t+this.phone,{appVerifier:i}=this;g["a"].auth().signInWithPhoneNumber(e,i).then(t=>{window.confirmationResult=t,this.verifyCode=!0,this.verifyPhone=!1,this.$store.commit("Loading_State",!1)}).catch((function(t){console.log(t),this.error=t}))}else!1===t.data.data.collect?(this.$store.commit("Loading_State",!1),this.error="ເບີໂທບໍ່ຖືກຕ້ອງ"):(this.$store.commit("Loading_State",!1),this.error="ມີບາງຢ່າງຜິດພາດ ກະລຸນາລອງໃໝ່");this.$store.commit("Loading_State",!1)}}).catch(t=>{this.error=t,this.$store.commit("Loading_State",!1)}).finally(()=>{this.loading=!1}))}catch(t){console.error("Error initializing reCAPTCHA:",t)}},verifyOtp(){this.btnVerify=!0;const t=Array.from(this.$refs.otpInput.otp).join("");window.confirmationResult.confirm(t).then(t=>{if(t){const e=t.user;localStorage.setItem("id_token",e._lat)}try{this.$store.commit("Loading_State",!0);const t=localStorage.getItem("id_token"),e={...this.user,id_token:t};this.$store.dispatch("auth/confirmLogin",e)}catch(e){this.$store.commit("Toast_State",{value:!0,color:"success",msg:e})}finally{this.$store.commit("Toast_State",{value:!0,color:"success",msg:"Login Success"})}this.$store.commit("Loading_State",!1)}).catch((function(t){console.log(t),this.error=t})).finally(()=>{this.btnVerify=!1})},...Object(f["b"])({}),initReCaptcha(){setTimeout(()=>{window.recaptchaVerifier=new g["a"].auth.RecaptchaVerifier("recaptcha-container",{size:"invisible","expired-callback":function(){}}),this.appVerifier=window.recaptchaVerifier},1e3)},handleOnComplete(t){this.code=t},handleClearInput(){this.$refs.otpInput.clearInput()}},watch:{phone(){this.error=""}},created(){const t=localStorage.getItem("confirmAccount");this.showPhone=this.$store.getters["auth/getLoginPhone"],this.user=JSON.parse(t),this.showPhone||y["a"].push({name:"Login"}),this.initReCaptcha()}},C=b,v=(i("47f3"),i("4a4e")),_=Object(v["a"])(C,u,m,!1,null,null,null);e["default"]=_.exports}}]);
//# sourceMappingURL=chunk-32819351.b9de738d.js.map