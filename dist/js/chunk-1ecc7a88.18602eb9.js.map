{"version":3,"sources":["webpack:///./src/views/auth/CheckPhone.vue?5f4a","webpack:///./src/views/auth/CheckPhone.vue","webpack:///src/views/auth/CheckPhone.vue","webpack:///./src/views/auth/CheckPhone.vue?2af6","webpack:///./src/views/auth/CheckPhone.vue?2511"],"names":["_c","attrs","staticClass","staticStyle","require","on","$event","model","value","_vm","callback","phone","expression","ref","btnVerify","staticRenderFns","render","name","title","data","loading","verifyCode","verifyPhone","showPhone","code","user","error","phoneRule","v","length","appVerifier","methods","getOtp","initReCaptcha","$axios","post","credential","password","then","res","collect","countryCode","phoneNumber","setTimeout","firebase","auth","languageCode","signInWithPhoneNumber","confirmationResult","window","catch","verifyOtp","Array","from","$refs","otpInput","otp","join","console","log","confirm","token","localStorage","setItem","_lat","$store","commit","id_token","getItem","dispatch","color","msg","mapActions","recaptchaVerifier","RecaptchaVerifier","size","handleOnComplete","handleClearInput","clearInput","watch","created","getters","JSON","parse","router","push","component"],"mappings":"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","file":"js/chunk-1ecc7a88.18602eb9.js","sourcesContent":["export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--9-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--9-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--9-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--9-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./CheckPhone.vue?vue&type=style&index=0&id=365c6c94&prod&lang=scss&\"","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('v-container',[_c('div',{attrs:{\"id\":\"recaptcha-container\"}}),_c('v-row',{attrs:{\"align\":\"center\",\"justify\":\"center\"}},[_c('v-col',{attrs:{\"cols\":\"12\",\"sm\":\"12\",\"md\":\"12\"}},[_c('v-card',{staticClass:\"elevation-1\",staticStyle:{\"display\":\"flex\",\"margin\":\"auto\"},attrs:{\"max-width\":\"600\"}},[_c('v-card-text',{staticClass:\"py-16 px-16\"},[_c('v-row',{attrs:{\"justify\":\"center\"}},[_c('v-col',{attrs:{\"justify\":\"center\"}},[_c('v-img',{staticClass:\"logo\",attrs:{\"src\":require(\"@/assets/logo-finalized.png\"),\"max-height\":\"150\",\"max-width\":\"250\",\"alt\":\"Logo\"}})],1)],1),(_vm.verifyPhone)?_c('div',[_c('h3',{staticClass:\"text-center display-5 black--text mb-8 mt-4\"},[_vm._v(\" Your phone number (\"+_vm._s(_vm.showPhone)+\") \")]),_c('v-text-field',{staticClass:\"input-number\",attrs:{\"label\":\"Phone\",\"single-line\":\"\",\"prepend-inner-icon\":\"mdi-phone\",\"solo\":\"\",\"type\":\"number\",\"rules\":_vm.phoneRule},on:{\"keyup\":function($event){if(!$event.type.indexOf('key')&&_vm._k($event.keyCode,\"enter\",13,$event.key,\"Enter\"))return null;return _vm.getOtp.apply(null, arguments)}},model:{value:(_vm.phone),callback:function ($$v) {_vm.phone=$$v},expression:\"phone\"}}),_c('p',{staticClass:\"errors\"},[_vm._v(\" \"+_vm._s(_vm.error)+\" \")]),_c('div',{staticClass:\"text-center\"},[_c('v-btn',{staticClass:\"login mt-6 py-6\",attrs:{\"block\":\"\",\"loading\":_vm.loading,\"disabled\":_vm.loading},on:{\"click\":_vm.getOtp}},[_vm._v(\" Get OTP \")])],1)],1):_vm._e(),(_vm.verifyCode)?_c('div',[_c('h2',{staticClass:\"text-center display-5 black--text mb-0 mt-4\"},[_vm._v(\" Verify Code OTP \")]),_c('p',{staticClass:\"text-center display-5 black--text mb-8 mt-0\"},[_vm._v(\" Input Code from SMS \")]),_c('v-form',{ref:\"form\",attrs:{\"lazy-validation\":\"\"}},[_c('v-row',[_c('v-col',{attrs:{\"cols\":\"12\",\"sm\":\"12\",\"md\":\"12\"}},[_c('div',{staticStyle:{\"display\":\"flex\",\"flex-direction\":\"row\"}},[_c('v-otp-input',{ref:\"otpInput\",staticClass:\"otp\",attrs:{\"input-classes\":\"otp-input\",\"separator\":\"\",\"num-inputs\":6,\"should-auto-focus\":true,\"is-input-num\":true},on:{\"on-complete\":_vm.handleOnComplete}}),_c('v-btn',{staticStyle:{\"margin\":\"auto\"},attrs:{\"text\":\"\",\"small\":\"\"},on:{\"click\":function($event){return _vm.handleClearInput()}}},[_vm._v(\" Clear \")])],1)])],1),_c('div',{staticClass:\"text-center\"},[_c('v-btn',{staticClass:\"login mt-6 py-6\",attrs:{\"block\":\"\",\"loading\":_vm.btnVerify,\"disabled\":_vm.btnVerify},on:{\"click\":_vm.verifyOtp}},[_vm._v(\" Confirm \")])],1)],1)],1):_vm._e()],1)],1)],1)],1)],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <v-container>\n    <div id=\"recaptcha-container\" />\n    <v-row\n      align=\"center\"\n      justify=\"center\"\n    >\n      <v-col\n        cols=\"12\"\n        sm=\"12\"\n        md=\"12\"\n      >\n        <v-card\n          class=\"elevation-1\"\n          max-width=\"600\"\n          style=\"display: flex; margin: auto\"\n        >\n          <v-card-text class=\"py-16 px-16\">\n            <v-row justify=\"center\">\n              <v-col justify=\"center\">\n                <v-img\n                  src=\"@/assets/logo-finalized.png\"\n                  max-height=\"150\"\n                  max-width=\"250\"\n                  alt=\"Logo\"\n                  class=\"logo\"\n                />\n              </v-col>\n            </v-row>\n            <div v-if=\"verifyPhone\">\n              <h3 class=\"text-center display-5 black--text mb-8 mt-4\">\n                Your phone number ({{ showPhone }})\n              </h3>\n              <v-text-field\n                v-model=\"phone\"\n                label=\"Phone\"\n                single-line\n                prepend-inner-icon=\"mdi-phone\"\n                solo\n                type=\"number\"\n                :rules=\"phoneRule\"\n                class=\"input-number\"\n                @keyup.enter=\"getOtp\"\n              />\n\n              <p class=\"errors\">\n                {{ error }}\n              </p>\n              <!--              <p class=\"errors\">-->\n              <!--                {{ server_errors.start_month }}-->\n              <!--              </p>-->\n\n              <div class=\"text-center\">\n                <v-btn\n                  block\n                  class=\"login mt-6 py-6\"\n                  :loading=\"loading\"\n                  :disabled=\"loading\"\n                  @click=\"getOtp\"\n                >\n                  Get OTP\n                </v-btn>\n              </div>\n            </div>\n            <div v-if=\"verifyCode\">\n              <h2 class=\"text-center display-5 black--text mb-0 mt-4\">\n                Verify Code OTP\n              </h2>\n              <p class=\"text-center display-5 black--text mb-8 mt-0\">\n                Input Code from SMS\n              </p>\n              <v-form\n                ref=\"form\"\n                lazy-validation\n              >\n                <v-row>\n                  <v-col\n                    cols=\"12\"\n                    sm=\"12\"\n                    md=\"12\"\n                  >\n                    <div style=\"display: flex; flex-direction: row\">\n                      <v-otp-input\n                        ref=\"otpInput\"\n                        input-classes=\"otp-input\"\n                        separator=\"\"\n                        :num-inputs=\"6\"\n                        :should-auto-focus=\"true\"\n                        :is-input-num=\"true\"\n                        class=\"otp\"\n                        @on-complete=\"handleOnComplete\"\n                      />\n                      <v-btn\n                        text\n                        small\n                        style=\"margin: auto\"\n                        @click=\"handleClearInput()\"\n                      >\n                        Clear\n                      </v-btn>\n                    </div>\n                  </v-col>\n                </v-row>\n                <div class=\"text-center\">\n                  <v-btn\n                    block\n                    class=\"login mt-6 py-6\"\n                    :loading=\"btnVerify\"\n                    :disabled=\"btnVerify\"\n                    @click=\"verifyOtp\"\n                  >\n                    Confirm\n                  </v-btn>\n                </div>\n              </v-form>\n            </div>\n          </v-card-text>\n        </v-card>\n      </v-col>\n    </v-row>\n  </v-container>\n</template>\n<script>\nimport { mapActions } from \"vuex\";\nimport firebase from \"firebase\";\nimport router from \"@/router\";\n\nexport default {\n  name: \"CheckPhone\",\n  title() {\n    return `Vientiane Waste Co-Dev|Login`;\n  },\n  data: () => ({\n    loading: false,\n    btnVerify: false,\n    verifyCode: false,\n    verifyPhone: true,\n    phone: \"\",\n    showPhone: \"\",\n    code: \"\",\n    user: {},\n    error: \"\",\n    phoneRule: [\n      (v) => !!v || \"Phone is required\",\n      (v) => (v && v.length >= 8) || \"Phone must be more than 8 characters\",\n    ],\n    appVerifier: \"\",\n  }),\n\n  methods: {\n    getOtp() {\n      this.initReCaptcha();\n      if (this.phone.length == 8) {\n        // Check Phone number\n        this.loading = true;\n        this.$axios\n          .post(\"auth/check-phone\", {\n            credential: this.user.credential,\n            password: this.user.password,\n            phone: this.phone,\n          })\n          .then((res) => {\n            if (res.data.code === 200) {\n              if (res.data.data.collect === true) {\n                // Send OTP\n                this.loading = true;\n                const countryCode = \"+85620\"; // laos\n                const phoneNumber = countryCode + this.phone;\n                const appVerifier = this.appVerifier;\n\n                setTimeout(() => {\n                  firebase.auth().languageCode = \"en\";\n                  firebase\n                    .auth()\n                    .signInWithPhoneNumber(phoneNumber, appVerifier)\n                    .then((confirmationResult) => {\n                      window.confirmationResult = confirmationResult;\n                      this.verifyCode = true;\n                      this.verifyPhone = false;\n                      this.loading = false;\n                    })\n                    .catch((error) => {\n                      this.error = error;\n                      this.loading = false;\n                    }, 15000);\n                });\n              } else if (res.data.data.collect === false) {\n                this.loading = false;\n                this.error = \"ເບີໂທບໍ່ຖືກຕ້ອງ\";\n              } else {\n                this.loading = false;\n                this.error = \"ມີບາງຢ່າງຜິດພາດ ກະລຸນາລອງໃໝ່\";\n              }\n              this.loading = false;\n            }\n          })\n          .catch((error) => {\n            this.error = error;\n            this.loading = false;\n          });\n      }\n    },\n\n    verifyOtp() {\n      this.btnVerify = true;\n      const code = Array.from(this.$refs.otpInput.otp).join('');\n      console.log(code, '88');\n      window.confirmationResult\n        .confirm(code)\n        .then((res) => {\n          if (res) {\n            this.btnVerify = false;\n            const token = res.user;\n            console.log(token, 'token');\n            localStorage.setItem(\"id_token\", token._lat);\n          }\n          try {\n            this.$store.commit(\"Loading_State\", true);\n            const id_token = localStorage.getItem(\"id_token\");\n            console.log(id_token, 'id_token');\n            const user = { ...this.user, id_token };\n            this.$store.dispatch(\"auth/confirmLogin\", user);\n          } catch (error) {\n            this.$store.commit(\"Toast_State\", {\n              value: true,\n              color: \"success\",\n              msg: error,\n            });\n          } finally {\n            this.$store.commit(\"Toast_State\", {\n              value: true,\n              color: \"success\",\n              msg: \"Login Success\",\n            });\n          }\n          this.$store.commit(\"Loading_State\", false);\n          // this.$store.commit(\"Loading_State\", true);\n        })\n        .catch(function () {\n          this.$store.commit(\"Toast_State\", {\n            value: true,\n            color: \"error\",\n            msg: \"ມີບາງຢ່າງຜິດພາດ ກະລຸນາລອງໃໝ່\",\n          });\n        });\n    },\n\n    ...mapActions({\n      // AdminLogin: \"User/LoginUser\",\n    }),\n    // Submit() {\n    //   if (this.$refs.form.validate() == true) {\n    //     this.AdminSignIn();\n    //   }\n    // },\n    initReCaptcha() {\n      window.recaptchaVerifier = new firebase.auth.RecaptchaVerifier(\n        \"recaptcha-container\",\n        {\n          size: \"invisible\",\n          \"expired-callback\": function () {},\n        },\n      );\n      //\n      this.appVerifier = window.recaptchaVerifier;\n    },\n    handleOnComplete(value) {\n      this.code = value;\n    },\n    handleClearInput() {\n      this.$refs.otpInput.clearInput();\n    },\n  },\n  watch: {\n    phone() {\n      this.error = \"\";\n    },\n  },\n  created() {\n    const data = localStorage.getItem(\"confirmAccount\");\n    this.showPhone = this.$store.getters[\"auth/getLoginPhone\"];\n\n    this.user = JSON.parse(data);\n    if (!this.showPhone) {\n      router.push({ name: \"Login\" });\n    }\n  },\n};\n</script>\n\n<style lang=\"scss\">\n@import \"../../../public/scss/main.scss\";\n\n.login {\n  background-color: $primary-color !important;\n  color: white !important;\n  font-size: 18px !important;\n}\n\n.v-text-field.v-text-field--solo:not(.v-text-field--solo-flat)\n  > .v-input__control\n  > .v-input__slot {\n  box-shadow: 0px -2px 0px -10px rgb(0 0 0 / 20%),\n    0px 2px 3px 0px rgb(0 0 0 / 14%), 1px 1px 2px 1px rgb(0 0 0 / 12%) !important;\n}\n\n.v-stepper__content {\n  padding: 8px 8px;\n}\n\n.otp-input {\n  width: 40px;\n  height: 40px;\n  padding: 5px;\n  margin: 0 10px;\n  font-size: 20px;\n  border-radius: 4px;\n  border: 1px solid rgba(0, 0, 0, 0.3);\n  text-align: center;\n\n  &.error {\n    border: 1px solid red !important;\n  }\n}\n\n.otp-input::-webkit-inner-spin-button,\n.otp-input::-webkit-outer-spin-button {\n  -webkit-appearance: none;\n  margin: 0;\n}\n\n@media only screen and (max-width: 600px) {\n  //.otp{\n  //  padding: 4px 4px;\n  //  margin-left: -64px;\n  //}\n  .otp-input {\n    width: 30px;\n    height: 30px;\n    padding: 3px;\n    margin: 0 5px;\n    font-size: 18px;\n    border-radius: 4px;\n    border: 1px solid rgba(0, 0, 0, 0.3);\n    text-align: center;\n\n    &.error {\n      border: 1px solid red !important;\n    }\n  }\n}\n</style>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./CheckPhone.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./CheckPhone.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./CheckPhone.vue?vue&type=template&id=365c6c94&\"\nimport script from \"./CheckPhone.vue?vue&type=script&lang=js&\"\nexport * from \"./CheckPhone.vue?vue&type=script&lang=js&\"\nimport style0 from \"./CheckPhone.vue?vue&type=style&index=0&id=365c6c94&prod&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}