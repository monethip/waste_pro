(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-75ff4713"],{"06d8":function(t,e,s){"use strict";var a=s("8510"),o=s("9535"),n=s("bb19"),i=URLSearchParams.prototype,r=o(i.forEach);a&&!("size"in i)&&n(i,"size",{get:function(){var t=0;return r(this,(function(){t++})),t},configurable:!0,enumerable:!0})},"10e0":function(t,e,s){"use strict";var a=s("6bc8"),o=s("9535"),n=s("9768"),i=s("419a"),r=URLSearchParams,l=r.prototype,c=o(l.getAll),d=o(l.has),u=new r("a=1");!u.has("a",2)&&u.has("a",void 0)||a(l,"has",(function(t){var e=arguments.length,s=e<2?void 0:arguments[1];if(e&&void 0===s)return d(this,t);var a=c(this,t);i(e,1);var o=n(s),r=0;while(r<a.length)if(a[r++]===o)return!0;return!1}),{enumerable:!0,unsafe:!0})},"2e99":function(t,e,s){"use strict";s("54d9")},"347c":function(t,e,s){t.exports=s.p+"img/pin1.d74f27bd.svg"},"419a":function(t,e,s){"use strict";var a=TypeError;t.exports=function(t,e){if(t<e)throw new a("Not enough arguments");return t}},"54d9":function(t,e,s){},"67f8":function(t,e,s){"use strict";s.r(e);var a=s("1957"),o=s("45f7"),n=s("84ff"),i=s("dff2"),r=s("2d66"),l=s("8042"),c=s("2161"),d=s("0002"),u=s("a972"),m=s("3675"),h=s("d736"),f=function(){var t=this,e=t._self._c;return e(l["a"],[e(a["a"],{staticClass:"mt-n4",attrs:{large:""}},[e(o["a"],{staticClass:"text-primary",attrs:{text:""},on:{click:function(e){return t.backPrevios()}}},[e(d["a"],[t._v("mdi-keyboard-backspace")])],1),t._v("Export ຂໍ້ມູນລູກຄ້າບໍລິສັດໃນແຜນເສັ້ນທາງ "),e(m["a"]),e("span",{staticClass:"mr-4"},[e(d["a"],{attrs:{color:"red"}},[t._v("mdi-map-marker")]),t._v("ຢູ່ໃນແຜນແລ້ວ ")],1),e("span",[e(d["a"],{staticStyle:{color:"#49a3da"}},[t._v("mdi-map-marker")]),t._v("ຍັງບໍທັນຢູ່ໃນແຜນ ")],1)],1),e(u["a"],[e(r["a"],{staticClass:"mb-4",attrs:{cols:"12"}},[t.customers?e("GmapMap",{staticStyle:{width:"100%",height:"450px"},attrs:{center:t.getCenter().lat>0||t.getCenter().lat<0?t.getCenter():{lat:0,lng:0},zoom:14,"disable-default-u-i":!0}},[e("gmap-info-window",{attrs:{options:t.infoOptions,position:t.infoPosition,opened:t.infoOpened,conent:t.infoContent},on:{closeclick:function(e){t.infoOpened=!1}}},[t._v(" "+t._s(t.infoContent)+" ")]),t._l(t.customers,(function(s,a){return e("GmapMarker",{key:a,attrs:{position:t.getMarkers(s),draggable:!1,icon:t.getSiteIcon(s),animation:2,clickable:!0,label:(a+1).toString()},on:{click:function(e){return t.toggleInfo(s,a)}}})}))],2):t._e()],1)],1),e(u["a"],{staticClass:"mb-n6"},[e(r["a"],[e(o["a"],{staticClass:"btn-primary",attrs:{loading:t.loading,disabled:t.loading},on:{click:function(e){return t.exportRoutePlan()}}},[e(d["a"],[t._v("mdi-arrow-right-bold-circle-outline")])],1)],1),e(r["a"],[t.customers?e("h4",[t._v(" ລວມລູກຄ້າ "+t._s(t.customers.length)+" ຄົນ ")]):t._e()]),e(r["a"],[e(h["a"],{attrs:{outlined:"",dense:"",clearable:"","prepend-inner-icon":"mdi-magnify",label:"Search",type:"text"},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.Search()}},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}})],1)],1),e("div",[e(n["a"],[e(n["a"],{attrs:{flat:""}},[e(i["b"],[e("div",[e(o["a"],{attrs:{text:"",color:"error"},on:{click:t.deleteItem}},[e(d["a"],{attrs:{medium:""}},[t._v(" mdi-delete ")])],1)],1),e(c["a"],{attrs:{headers:t.headers,items:t.customers,search:t.search,"disable-pagination":!0,"hide-default-footer":"","show-select":""},scopedSlots:t._u([{key:"item.index",fn:function(s){return[e("div",[t._v(t._s(s.index+1))])]}},{key:"item.address_detail",fn:function({item:s}){return t._l(s.village_details,(function(s,a){return e("div",{key:a},[e("span",[t._v(t._s(s.name))])])}))}},{key:"item.address",fn:function({item:s}){return[s.district&&s.village?e("div",[t._v(" "+t._s(s.district.name)+", "+t._s(s.village.name)+" ")]):t._e()]}},{key:"item.actions",fn:function({item:s}){return[e(d["a"],{staticClass:"mr-2",attrs:{small:""},on:{click:function(e){return t.viewPage(s.id)}}},[t._v(" mdi-eye ")])]}}]),model:{value:t.selectedRows,callback:function(e){t.selectedRows=e},expression:"selectedRows"}})],1)],1)],1)],1),e("ModalDelete",[[e(i["a"],[e(m["a"]),e(o["a"],{attrs:{color:"blue darken-1",text:""},on:{click:t.closeDelete}},[t._v(" Cancel ")]),e(o["a"],{attrs:{color:"blue darken-1",text:"",loading:t.loading,disabled:t.loading},on:{click:t.deleteItemConfirm}},[t._v(" OK ")]),e(m["a"])],1)]],2)],1)},p=[],g=(s("e34a"),s("bb0ef"),s("10e0"),s("06d8"),{name:"Company",title(){return"Vientiane Waste Co-Dev|Export Company"},props:["items","villages"],data(){return{customers:[],countcutomer:0,loading:!1,customerId:"",search:"",oldVal:"",selectedVillage:[],selectedCustomer:[],exclude_company:[],selectedRows:[],customer:{},headers:[{text:"ບໍລິສັດ",value:"company_name"},{text:"Phone",value:"user.phone",sortable:!1},{text:"ລາຍລະອຽດທີ່ຢູ່",value:"address_detail"},{text:"ບ້ານ",value:"village.name",sortable:!0},{text:"ເມືອງ",value:"district.name",sortable:!0}],latlng:{lat:0,lng:0},markers:[],infoPosition:null,infoContent:null,infoOpened:!1,infoCurrentKey:null,infoOptions:{pixelOffset:{width:0,height:-35}}}},watch:{search(t){""==t&&this.fetchData()}},created(){this.fetchData()},methods:{backPrevios(){this.$router.go(-1)},fetchData(){this.customers=this.items,this.selectedVillage=this.villages},closeDelete(){this.$store.commit("modalDelete_State",!1)},deleteItem(){this.selectedRows.length&&this.$store.commit("modalDelete_State",!0)},deleteItemConfirm(){this.selectedCustomer=[],this.$store.commit("Loading_State",!0);for(let t=0;t<this.selectedRows.length;t++){const e=this.customers.indexOf(this.selectedRows[t]);this.selectedCustomer.push(this.customers[e]),this.customers.splice(e,1)}this.selectedCustomer.filter(t=>{this.exclude_company.push(t.id)}),this.$store.commit("Toast_State",{value:!0,color:"success",msg:"ລຶບຂໍ້ມູນສຳເລັດແລ້ວ"}),this.selectedRows=[],this.fetchData(),this.$store.commit("Loading_State",!1),this.$store.commit("modalDelete_State",!1)},exportRoutePlan(){this.customers.length?(this.$store.commit("Loading_State",!0),this.$axios.post("export-company-location",{headers:{exclude_companies:this.exclude_company,villages:this.selectedVillage}},{responseType:"blob"}).then(t=>{200==t.status&&(console.log("Success"),setTimeout(()=>{this.$store.commit("Loading_State",!1);const e=window.URL.createObjectURL(new Blob([t.data])),s=document.createElement("a");s.href=e,s.setAttribute("download","company_location.xlsx"),document.body.appendChild(s),s.click(),document.body.removeChild(s)},300),this.$router.push({name:"Plan"}))}).catch(t=>{this.$store.commit("Toast_State",{value:!0,color:"error",msg:t.response?t.response.data.message:"Something went wrong"}),this.$store.commit("Loading_State",!1)})):this.$store.commit("Toast_State",{value:!0,color:"error",msg:"ກາລຸນາເລືອກລູກຄ້າກ່ອນ"})},viewPage(t){this.$router.push({name:"ViewClient",params:{id:t}})},getCenter(){if(this.customers.length){if(null==parseFloat(this.customers[0].lat))return this.latlng;const t={lat:parseFloat(this.customers[0].lat),lng:parseFloat(this.customers[0].lng)};return t}return this.latlng},getMarkers(t){if(null!==t.customer)return{lat:parseFloat(t.lat),lng:parseFloat(t.lng)}},getSiteIcon(t){const e={url:s("347c"),zoomControl:!0,mapTypeControl:!1,scaleControl:!1,streetViewControl:!1,rotateControl:!1,fullscreenControl:!1,disableDefaultUi:!1,size:{width:35,height:55,f:"px",b:"px"},scaledSize:{width:35,height:55,f:"px",b:"px"}},a={url:s("f742"),zoomControl:!0,mapTypeControl:!1,scaleControl:!1,streetViewControl:!1,rotateControl:!1,fullscreenControl:!1,disableDefaultUi:!1,size:{width:35,height:55,f:"px",b:"px"},scaledSize:{width:35,height:55,f:"px",b:"px"}};try{switch(t.route_plan_details_count){case 0:return e;case 1:return a}}catch(o){return e}},toggleInfo(t,e){this.infoPosition=this.getMarkers(t),this.infoContent=t.company_name,this.infoCurrentKey==e?this.infoOpened=!this.infoOpened:(this.infoOpened=!0,this.infoCurrentKey=e)}}}),v=g,b=(s("2e99"),s("d22c")),_=Object(b["a"])(v,f,p,!1,null,null,null);e["default"]=_.exports},8042:function(t,e,s){"use strict";s("3bf8"),s("618a");var a=s("1ed6");function o(t){return a["a"].extend({name:"v-"+t,functional:!0,props:{id:String,tag:{type:String,default:"div"}},render(e,{props:s,data:a,children:o}){a.staticClass=`${t} ${a.staticClass||""}`.trim();const{attrs:n}=a;if(n){a.attrs={};const t=Object.keys(n).filter(t=>{if("slot"===t)return!1;const e=n[t];return t.startsWith("data-")?(a.attrs[t]=e,!1):e||"string"===typeof e});t.length&&(a.staticClass+=" "+t.join(" "))}return s.id&&(a.domProps=a.domProps||{},a.domProps.id=s.id),e(s.tag,a,o)}})}var n=s("727d");e["a"]=o("container").extend({name:"v-container",functional:!0,props:{id:String,tag:{type:String,default:"div"},fluid:{type:Boolean,default:!1}},render(t,{props:e,data:s,children:a}){let o;const{attrs:i}=s;return i&&(s.attrs={},o=Object.keys(i).filter(t=>{if("slot"===t)return!1;const e=i[t];return t.startsWith("data-")?(s.attrs[t]=e,!1):e||"string"===typeof e})),e.id&&(s.domProps=s.domProps||{},s.domProps.id=e.id),t(e.tag,Object(n["a"])(s,{staticClass:"container",class:Array({"container--fluid":e.fluid}).concat(o||[])}),a)}})},bb0ef:function(t,e,s){"use strict";var a=s("6bc8"),o=s("9535"),n=s("9768"),i=s("419a"),r=URLSearchParams,l=r.prototype,c=o(l.append),d=o(l["delete"]),u=o(l.forEach),m=o([].push),h=new r("a=1&a=2&b=3");h["delete"]("a",1),h["delete"]("b",void 0),h+""!=="a=2"&&a(l,"delete",(function(t){var e=arguments.length,s=e<2?void 0:arguments[1];if(e&&void 0===s)return d(this,t);var a=[];u(this,(function(t,e){m(a,{key:e,value:t})})),i(e,1);var o,r=n(t),l=n(s),h=0,f=0,p=!1,g=a.length;while(h<g)o=a[h++],p||o.key===r?(p=!0,d(this,o.key)):f++;while(f<g)o=a[f++],o.key===r&&o.value===l||c(this,o.key,o.value)}),{enumerable:!0,unsafe:!0})},bb19:function(t,e,s){"use strict";var a=s("3ef6"),o=s("0d00");t.exports=function(t,e,s){return s.get&&a(s.get,e,{getter:!0}),s.set&&a(s.set,e,{setter:!0}),o.f(t,e,s)}},f742:function(t,e,s){t.exports=s.p+"img/pin2.b23d8eec.svg"}}]);
//# sourceMappingURL=chunk-75ff4713.71ab6669.js.map