(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-618a6551"],{"6e73":function(t,e,n){"use strict";n("caf2")},caf2:function(t,e,n){},fcfb:function(t,e,n){"use strict";n.r(e);var a=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",[a("div",{attrs:{id:"recaptcha-container"}}),a("v-row",{attrs:{align:"center",justify:"center"}},[a("v-col",{attrs:{cols:"12",sm:"12",md:"12"}},[a("v-card",{staticClass:"elevation-1",staticStyle:{display:"flex",margin:"auto"},attrs:{"max-width":"600"}},[a("v-card-text",{staticClass:"py-16 px-16"},[a("v-row",{attrs:{justify:"center"}},[a("v-col",{attrs:{justify:"center"}},[a("v-img",{staticClass:"logo",attrs:{src:n("de09"),"max-height":"150","max-width":"250",alt:"Logo"}})],1)],1),t.verifyPhone?a("div",[a("h3",{staticClass:"text-center display-5 black--text mb-8 mt-4"},[t._v(" Your phone number ("+t._s(t.showPhone)+") ")]),a("v-text-field",{staticClass:"input-number",attrs:{label:"Phone","single-line":"","prepend-inner-icon":"mdi-phone",solo:"",type:"number",rules:t.phoneRule},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.getOtp.apply(null,arguments)}},model:{value:t.phone,callback:function(e){t.phone=e},expression:"phone"}}),a("p",{staticClass:"errors"},[t._v(" "+t._s(t.error)+" ")]),a("div",{staticClass:"text-center"},[a("v-btn",{staticClass:"login mt-6 py-6",attrs:{block:"",loading:t.loading,disabled:t.loading},on:{click:t.getOtp}},[t._v("Get OTP ")])],1)],1):t._e(),t.verifyCode?a("div",[a("h2",{staticClass:"text-center display-5 black--text mb-0 mt-4"},[t._v(" Verify Code OTP ")]),a("p",{staticClass:"text-center display-5 black--text mb-8 mt-0"},[t._v("Input Code from SMS")]),a("v-form",{ref:"form",attrs:{"lazy-validation":""}},[a("v-row",[a("v-col",{attrs:{cols:"12",sm:"12",md:"12"}},[a("div",{staticStyle:{display:"flex","flex-direction":"row"}},[a("v-otp-input",{ref:"otpInput",staticClass:"otp",attrs:{"input-classes":"otp-input",separator:"","num-inputs":6,"should-auto-focus":!0,"is-input-num":!0},on:{"on-complete":t.handleOnComplete}}),a("v-btn",{staticStyle:{margin:"auto"},attrs:{text:"",small:""},on:{click:function(e){return t.handleClearInput()}}},[t._v("Clear")])],1)])],1),a("div",{staticClass:"text-center"},[a("v-btn",{staticClass:"login mt-6 py-6",attrs:{block:"",loading:t.btnVerify,disabled:t.btnVerify},on:{click:t.verifyOtp}},[t._v("Confirm ")])],1)],1)],1):t._e()],1)],1)],1)],1)],1)},o=[],i=n("5530"),r=n("2f62"),s=n("2591"),c=n("a18c"),l={name:"CheckPhone",title:function(){return"Vientiane Waste Co-Dev|Login"},data:function(){return{loading:!1,btnVerify:!1,verifyCode:!1,verifyPhone:!0,phone:"",showPhone:"",code:"",user:{},error:"",phoneRule:[function(t){return!!t||"Phone is required"},function(t){return t&&t.length>=8||"Phone must be more than 8 characters"}],appVerifier:""}},methods:Object(i["a"])(Object(i["a"])({getOtp:function(){var t=this;this.initReCaptcha(),8==this.phone.length&&(this.loading=!0,this.$axios.post("auth/check-phone",{credential:this.user.credential,password:this.user.password,phone:this.phone}).then((function(e){if(200===e.data.code){if(!0===e.data.data.collect){t.loading=!0;var n="+85620",a=n+t.phone,o=t.appVerifier;setTimeout((function(){s["a"].auth().languageCode="en",s["a"].auth().signInWithPhoneNumber(a,o).then((function(e){window.confirmationResult=e,t.verifyCode=!0,t.verifyPhone=!1,t.loading=!1})).catch((function(e){t.error=e,t.loading=!1}),15e3)}))}else!1===e.data.data.collect?(t.loading=!1,t.error="ເບີໂທບໍ່ຖືກຕ້ອງ"):(t.loading=!1,t.error="ມີບາງຢ່າງຜິດພາດ ກະລຸນາລອງໃໝ່");t.loading=!1}})).catch((function(e){t.error=e,t.loading=!1})))},verifyOtp:function(){var t=this;this.btnVerify=!0;var e=this.code;window.confirmationResult.confirm(e).then((function(e){if(e){t.btnVerify=!1;var n=e.user;localStorage.setItem("id_token",n._lat)}try{t.$store.commit("Loading_State",!0);var a=localStorage.getItem("id_token"),o=Object(i["a"])(Object(i["a"])({},t.user),{},{id_token:a});t.$store.dispatch("auth/confirmLogin",o)}catch(r){t.store.commit("Toast_State",{value:!0,color:"success",msg:r})}finally{t.$store.commit("Toast_State",{value:!0,color:"success",msg:"Login Success"})}t.store.commit("Loading_State",!1)})).catch((function(){this.store.commit("Toast_State",{value:!0,color:"error",msg:"ມີບາງຢ່າງຜິດພາດ ກະລຸນາລອງໃໝ່"})}))}},Object(r["b"])({})),{},{initReCaptcha:function(){window.recaptchaVerifier=new s["a"].auth.RecaptchaVerifier("recaptcha-container",{size:"invisible","expired-callback":function(){}}),this.appVerifier=window.recaptchaVerifier},handleOnComplete:function(t){this.code=t},handleClearInput:function(){this.$refs.otpInput.clearInput()}}),watch:{phone:function(){this.error=""}},created:function(){var t=localStorage.getItem("confirmAccount");this.showPhone=localStorage.getItem("phone"),this.user=JSON.parse(t),null===this.showPhone&&c["a"].push({name:"Login"})}},u=l,d=(n("6e73"),n("2877")),h=n("6544"),p=n.n(h),f=n("8336"),m=n("b0af"),v=n("99d9"),g=n("62ad"),b=n("a523"),y=n("4bd4"),C=n("adda"),w=n("0fd9"),x=n("8654"),k=Object(d["a"])(u,a,o,!1,null,null,null);e["default"]=k.exports;p()(k,{VBtn:f["a"],VCard:m["a"],VCardText:v["b"],VCol:g["a"],VContainer:b["a"],VForm:y["a"],VImg:C["a"],VRow:w["a"],VTextField:x["a"]})}}]);
//# sourceMappingURL=chunk-618a6551.23917905.js.map