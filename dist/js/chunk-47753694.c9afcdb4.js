(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-47753694"],{"075a":function(t,e,a){"use strict";a("675f")},"675f":function(t,e,a){},"6eceb":function(t,e,a){"use strict";a.d(e,"a",(function(){return o}));const o=t=>{""!==t.search?""!==t.oldVal?t.oldVal!==t.search&&(t.oldVal=t.search,t.pagination.current_page=1,t.fetchData()):(""!==t.search&&(t.pagination.current_page=1,t.fetchData()),t.oldVal=t.search):t.oldVal=""}},e8d1:function(t,e,a){"use strict";a.r(e);var o=a("2bc5"),s=a("8336"),n=a("b0af"),i=a("99d9"),r=a("cc20"),c=a("62ad"),m=a("a523"),l=a("8fea"),h=a("0fd9"),p=a("b974"),d=function(){var t=this,e=t._self._c;return e(m["a"],[e(o["a"],{staticClass:"pt-0",attrs:{large:""}},[t._v(" ລາຍງານຂໍ້ມູນບິນເກັບຂີ້ເຫື້ຍອພິເສດ ")]),e(h["a"],{staticClass:"mb-n6"},[e(c["a"],[e(s["a"],{staticClass:"btn-primary",on:{click:function(e){return t.exportData()}}},[t._v(" Export ")])],1),e(c["a"],[e(p["a"],{attrs:{outlined:"",dense:"",items:t.duration,"item-text":"name","item-value":"duration",label:"ຊ່ວງເວລາ"},model:{value:t.selectedDuration,callback:function(e){t.selectedDuration=e},expression:"selectedDuration"}})],1),"year"==t.selectedDuration?e(c["a"],[e("section",[e("date-picker",{staticStyle:{height:"40px"},attrs:{type:"year",placeholder:"ເລີ່ມປີ"},model:{value:t.year_from,callback:function(e){t.year_from=e},expression:"year_from"}})],1)]):t._e(),"year"==t.selectedDuration?e(c["a"],[e("section",[e("date-picker",{attrs:{type:"year",placeholder:"ຫາປີ"},model:{value:t.year_to,callback:function(e){t.year_to=e},expression:"year_to"}})],1)]):t._e(),"month"==t.selectedDuration?e(c["a"],[e("section",[e("date-picker",{attrs:{type:"month",placeholder:"ເລີ່ມເດືອນ"},model:{value:t.month_from,callback:function(e){t.month_from=e},expression:"month_from"}})],1)]):t._e(),"month"==t.selectedDuration?e(c["a"],[e("section",[e("date-picker",{attrs:{type:"month",placeholder:"ຫາເດືອນ"},model:{value:t.month_to,callback:function(e){t.month_to=e},expression:"month_to"}})],1)]):t._e()],1),e(h["a"],[e(c["a"],{attrs:{cols:""}},[e(p["a"],{attrs:{outlined:"",dense:"",items:t.collectionStatus,"item-text":"dis_play","item-value":"name",label:"ສະຖານະບໍລິການ",multiple:"",clearable:""},model:{value:t.selectedCollectionStatus,callback:function(e){t.selectedCollectionStatus=e},expression:"selectedCollectionStatus"}})],1),e(c["a"],{attrs:{col:""}},[e(p["a"],{attrs:{outlined:"",dense:"",items:t.paymentStatus,"item-text":"dis_play","item-value":"name",label:"ສະຖານະການຊຳລະ",multiple:"",clearable:""},model:{value:t.selectedPaymentStatus,callback:function(e){t.selectedPaymentStatus=e},expression:"selectedPaymentStatus"}})],1)],1),e("div",[t._l(t.summary,(function(a,o){return e(h["a"],{key:o},[e(c["a"],[a.year?e("p",[t._v(" ປີ "+t._s(a.year)+" ")]):t._e(),a.month?e("p",[t._v(" ເດືອນ "+t._s(a.month)+" ")]):t._e()]),e(c["a"],[e("p",[t._v(" ຍອດທີ່ປະຕິເສດ "),e("span",{staticClass:"success--text"},[t._v(t._s(Intl.NumberFormat().format(a.rejected_total)))])])]),e(c["a"],[e("p",[t._v(" ຍອດທີ່ຈ່າຍແລ້ວ(ລໍຖ້າການຢືນຢັນ) "),e("span",{staticClass:"success--text"},[t._v(t._s(Intl.NumberFormat().format(a.to_confirm_payment_total)))])])]),e(c["a"],[e("p",[t._v(" ຍອດທີ່ຈ່າຍແລ້ວ "),e("span",{staticClass:"success--text"},[t._v(t._s(Intl.NumberFormat().format(a.success_total)))])])]),e(c["a"],[e("p",[t._v(" ຍອດທີ່ຍັງບໍ່ຈ່າຍ "),e("span",{staticClass:"success--text"},[t._v(t._s(Intl.NumberFormat().format(a.pending_total))+" ")])])])],1)})),e(n["a"],[e(i["b"],[e(l["a"],{attrs:{headers:t.headers,items:t.invoices,search:t.search,"disable-pagination":!0,"hide-default-footer":""},scopedSlots:t._u([{key:"item.sub_total",fn:function({item:a}){return[e("div",[t._v(" "+t._s(Intl.NumberFormat().format(a.sub_total))+" ")])]}},{key:"item.total",fn:function({item:a}){return[e("div",[t._v(" "+t._s(Intl.NumberFormat().format(a.total))+" ")])]}},{key:"item.status",fn:function({item:a}){return[e(r["a"],{attrs:{label:"",color:t.statusColor(a.payment_status)}},[t._v(" "+t._s(t.paymentStatusText(a.payment_status))+" ")])]}},{key:"item.created_at",fn:function({item:a}){return[e("div",[e("span",[t._v(t._s(t.moment(a.created_at).format("DD-MM-YY")))])])]}}])})],1)],1),e("br"),[t.pagination.total_pages>1?e("Pagination",{attrs:{pagination:t.pagination,offset:t.offset},on:{paginate:function(e){return t.fetchData()}}}):t._e()]],2)],1)},u=[],_=a("6eceb"),f=(a("14d9"),a("c1df")),y=a.n(f),Y={title(){return"Vientiane Waste Co-Dev|Report Invoice"},data(){return{tab:"tab-1",customers:[],loading:!1,customerId:"",year_from:"",year_to:"",month_from:"",month_to:"",offset:12,pagination:{},per_page:15,search:"",oldVal:"",invoices:[],summary:{},selectedDuration:"year",duration:[{name:"ປີ",duration:"year"},{name:"ເດືອນ",duration:"month"}],invoiceType:"home",selectedCollectionStatus:[],collectionStatus:[{id:1,name:"requested",dis_play:"ຮ້ອງຂໍເກັບຂີ້ເຫື້ຍອ"},{id:2,name:"rejected",dis_play:"ປະຕິເສດເກັບຂີ້ເຫື້ຍອ"},{id:3,name:"approved",dis_play:"ອະນຸມັດເກັບຂີ້ເຫື້ຍອ"},{id:4,name:"collected",dis_play:"ເກັບຂີເຫື້ຍອສຳເລັດ"},{id:5,name:"collect_confirm",dis_play:"ລູກຄ້າຢືນຢັນການເກັບ"},{id:5,name:"collect_reject",dis_play:"ການເກັບຖືກປະຕິເສດ"}],selectedPaymentStatus:[],paymentStatus:[{id:1,name:"pending",dis_play:"ລໍຖ້າເກັບເງິນ"},{id:2,name:"to_confirm_payment",dis_play:"ລໍຖ້າຢືນຢັນຊຳລະ"},{id:3,name:"rejected",dis_play:"ປະຕິເສດການຊຳລະ"},{id:4,name:"success",dis_play:"ຊຳລະສຳເລັດ"}]}},methods:{fetchData(){const t=new FormData;t.append("page",this.pagination.current_page),t.append("per_page",this.per_page),t.append("duration",this.selectedDuration),""!==this.year_from&&""!==this.year_to&&"year"==this.selectedDuration&&(t.append("year_from",this.moment(this.year_from).format("YYYY")),t.append("year_to",this.moment(this.year_to).format("YYYY"))),""!==this.month_from&&""!==this.month_to&&"month"==this.selectedDuration&&(t.append("month_from",this.moment(this.month_from).format("YYYY-MM")),t.append("month_to",this.moment(this.month_to).format("YYYY-MM"))),this.selectedCollectionStatus.map(e=>{t.append("collect_statuses[]",e)}),this.selectedPaymentStatus.map(e=>{t.append("payment_statuses[]",e)}),this.$store.commit("Loading_State",!0),this.$axios.post("report-event-collection-payment",t).then(t=>{200==t.data.code&&setTimeout(()=>{this.$store.commit("Loading_State",!1),this.invoices=t.data.data.details.data,this.summary=t.data.data.summary,this.pagination=t.data.data.details.pagination},300)}).catch(t=>{this.$store.commit("Loading_State",!1),this.$store.commit("Toast_State",{value:!0,color:"error",msg:t.response.data.message})})},exportData(){const t=new FormData;t.append("type",this.invoiceType),t.append("duration",this.selectedDuration),t.append("download",1),""!==this.year_from&&""!==this.year_to&&"year"==this.selectedDuration&&(t.append("year_from",this.moment(this.year_from).format("YYYY")),t.append("year_to",this.moment(this.year_to).format("YYYY"))),""!==this.month_from&&""!==this.month_to&&"month"==this.selectedDuration&&(t.append("month_from",this.moment(this.month_from).format("YYYY-MM")),t.append("month_to",this.moment(this.month_to).format("YYYY-MM"))),this.selectedCollectionStatus.map(e=>{t.append("collect_statuses[]",e)}),this.selectedPaymentStatus.map(e=>{t.append("payment_statuses[]",e)}),this.$store.commit("Loading_State",!0),this.$axios.post("report-event-collection-payment",t).then(t=>{200==t.status&&(null!=t.data.data.download_link&&window.open(t.data.data.download_link),this.$store.commit("Loading_State",!1))}).catch(t=>{this.$store.commit("Toast_State",{value:!0,color:"error",msg:t.response.data.message}),this.$store.commit("Loading_State",!1)})},editPage(t){this.$router.push({name:"InvoiceDetail",params:{id:t}})},viewPage(t){this.$router.push({name:"InvoiceDetail",params:{id:t}})},Search(){Object(_["a"])(this)}},watch:{selectedPaymentStatus(){this.pagination.current_page="",this.fetchData()},selectedCollectionStatus(){this.pagination.current_page="",this.fetchData()},selectedDuration(){this.pagination.current_page="",this.fetchData()},search(t){this.pagination.current_page="",""==t&&this.fetchData()},year_from(t){const e=y()(t).format("YYYY"),a=y()(this.year_to).format("YYYY");this.pagination.current_page="",""!==e&&""!==a&&e>a&&(this.year_from=""),this.fetchData()},year_to(t){const e=y()(t).format("YYYY"),a=y()(this.year_from).format("YYYY");this.pagination.current_page="",""!==e&&""!==a&&e<a&&(this.year_to=""),this.fetchData()},month_from(t){const e=y()(t).format("YYYY-MM"),a=y()(this.month_to).format("YYYY-MM");""!==e&&""!==a&&e>a&&(this.month_from=""),this.pagination.current_page="",this.fetchData()},month_to(t){const e=y()(this.month_from).format("YYYY-MM"),a=y()(t).format("YYYY-MM");this.pagination.current_page="",""!==e&&""!==a&&a<e&&(this.month_to=""),this.pagination.current_page="",this.fetchData()},tab(t){"tab-1"==t?(this.fetchData(),this.invoiceType="home",this.$router.push({name:"Report-Invoice",query:{tab:"home"}}).catch(()=>{})):"tab-2"==t&&(this.fetchData(),this.invoiceType="company",this.$router.push({name:"Report-Invoice",query:{tab:"company"}}).catch(()=>{}))}},created(){"home"==this.$route.query.tab?(this.tab="tab-1",this.invoiceType="home",this.fetchData()):"company"==this.$route.query.tab&&(this.tab="tab-2",this.invoiceType="company",this.fetchData()),this.pagination=[]}},v={name:"InvoiceCollectionEvent",mixins:[Y],title(){return"Vientiane Waste Co-Dev|Report Invoice Collection Event"},data(){return{customers:[],loading:!1,customerId:"",offset:12,pagination:{},per_page:100,search:"",oldVal:"",headers:[{text:"ວັນທີ",value:"date",sortable:!1},{text:"ລູກຄ້າ",value:"full_name"},{text:"ສ່ວນຫຼຸດ",value:"discount"},{text:"SubTotal",value:"sub_total",sortable:!1},{text:"Total",value:"total",sortable:!1},{text:"ຊຳລະ",value:"status",sortable:!1},{text:"Type",value:"type",sortable:!1}]}},watch:{tab(){this.tab}},created(){this.fetchData()},methods:{Search(){Object(_["a"])(this)},statusColor(t){return"success"==t?"success":"pending"==t?"primary":"rejected"==t?"error":"info"},paymentStatusText(t){return"pending"==t?"ລໍຖ້າເກັບເງິນ":"to_confirm_payment"==t?"ລໍຖ້າຢືນຢັນຊຳລະ":"rejected"==t?"ປະຕິເສດການຊຳລະ":"success"==t?"ຊຳລະສຳເລັດ":""}}},g=v,b=(a("075a"),a("2877")),D=Object(b["a"])(g,d,u,!1,null,null,null);e["default"]=D.exports}}]);
//# sourceMappingURL=chunk-47753694.c9afcdb4.js.map